<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="ProductCategoryModel">

	<resultMap id="BaseResultMap" type="ProductCategoryModel">
		<id column="id" property="id" />
		<result column="parent_id" property="parentId" />
		<result column="child_id" property="childId" />
		<result column="show_status" property="showStatus" />
		<result column="all_parent_id" property="allParentId" />
		<result column="all_child_id" property="allChildId" />
		<result column="level" property="level" />
		<result column="name" property="name" />
		<result column="picture_url" property="pictureUrl"/>
		<result column="show_cover" property="showCover"/>
		<result column="course_category_type" property="courseCategoryType" />
		<result column="detail" property="detail" />
		<result column="misc" property="misc" />
		<result column="create_time" property="createTime" />
		<result column="update_time" property="updateTime" />
		<result column="is_leaf" property="isLeaf" />
		<result column="module" property="module" />
		<result column="classify" property="classify" />
		<result column="type_code" property="typeCode" />
        <result column="module_name" property="moduleName" />
        <result column="is_cooperation" property="isCooperation" />
        <result column="is_sync" property="isSync" />
        <result column="is_buy" property="isBuy" />
        <result column="course_count" property="courseCount" />
        <result column="chief_academy" property="chiefAcademy" />
	
	</resultMap>

	<!--字段 -->
	<sql id="base_column">parent_id,child_id,show_status,all_parent_id,all_child_id,level,name,picture_url,show_cover,course_category_type,detail,misc,
		create_time,update_time,is_leaf,module,classify,type_code,is_cooperation,is_sync,is_buy,course_count,chief_academy
	</sql>
	<sql id="all_column">
		id,
		<include refid="base_column" />
	</sql>

	<!-- 1.插入 -->
	<sql id="insertColumns">
		<trim suffixOverrides=",">
			<if test="id != null">id,</if>
			<if test="parentId != null">parent_id,</if>
			<if test="childId != null">child_id,</if>
			<if test="showStatus != null">show_status,</if>
			<if test="allParentId != null">all_parent_id,</if>
			<if test="allChildId != null">all_child_id,</if>
			<if test="level != null">level,</if>
			<if test="name != null">name,</if>
			<if test="pictureUrl != null">picture_url,</if>
			<if test="showCover != null">show_cover,</if>
			<if test="courseCategoryType != null">course_category_type,</if>
			<if test="detail != null">detail,</if>
			<if test="misc != null">misc,</if>
			<if test="createTime != null">create_time,</if>
			<if test="updateTime != null">update_time,</if>
			<if test="isLeaf != null">is_leaf,</if>
			<if test="module != null">module,</if>
			<if test="classify != null">classify,</if>
			<if test="typeCode != null">type_code,</if>
			<if test="isCooperation != null">is_cooperation,</if>
			<if test="isSync != null">is_sync,</if>
			<if test="isBuy != null">is_buy,</if>
			<if test="courseCount != null">course_count,</if>
			<if test="chiefAcademy != null">chief_academy,</if>
		</trim>
	</sql>
	<sql id="insertValues">
		<trim suffixOverrides=",">
			<if test="id != null">#{id},</if>
			<if test="parentId != null">#{parentId},</if>
			<if test="childId != null">#{childId},</if>
			<if test="showStatus != null">#{showStatus},</if>
			<if test="allParentId != null">#{allParentId},</if>
			<if test="allChildId != null">#{allChildId},</if>
			<if test="level != null">#{level},</if>
			<if test="name != null">#{name},</if>
			<if test="pictureUrl != null">#{pictureUrl},</if>
			<if test="showCover != null">#{showCover},</if>
			<if test="courseCategoryType != null">#{courseCategoryType},</if>
			<if test="detail != null">#{detail},</if>
			<if test="misc != null">#{misc},</if>
			<if test="createTime != null">#{createTime},</if>
			<if test="updateTime != null">#{updateTime},</if>
			<if test="isLeaf != null">#{isLeaf},</if>
			<if test="module != null">#{module},</if>
			<if test="classify != null">#{classify},</if>
			<if test="typeCode != null">#{typeCode},</if>
			<if test="isCooperation != null">#{isCooperation},</if>
			<if test="isSync != null">#{isSync},</if>
			<if test="isBuy != null">#{isBuy},</if>
			<if test="courseCount != null">#{courseCount},</if>
			<if test="chiefAcademy != null">#{chiefAcademy},</if>
		</trim>
	</sql>

	<insert id="addEntity" parameterType="ProductCategoryModel" useGeneratedKeys="true" keyProperty="id">
		insert into xd_course_product_category
		(
		<include refid="insertColumns" />
		)
		values
		(
		<include refid="insertValues" />
		)
	</insert>

	<!-- 2.更新 -->
	<update id="updateEntity" parameterType="java.util.Map">
		update xd_course_product_category
		<set>
			<if test="value != null and value.parentId != null">parent_id = #{value.parentId},</if>
			<if test="value != null and value.childId != null">child_id = #{value.childId},</if>
			<if test="value != null and value.showStatus != null">show_status = #{value.showStatus},</if>
			<if test="value != null and value.allParentId != null">all_parent_id = #{value.allParentId},</if>
			<if test="value != null and value.allChildId != null">all_child_id = #{value.allChildId},</if>
			<if test="value != null and value.level != null">level = #{value.level},</if>
			<if test="value != null and value.name != null">name = #{value.name},</if>
			<if test="value != null and value.pictureUrl != null">picture_url = #{value.pictureUrl},</if>
			<if test="value != null and value.showCover != null">show_cover = #{value.showCover},</if>
			<if test="value != null and value.courseCategoryType != null">course_category_type = #{value.courseCategoryType},</if>
			<if test="value != null and value.detail != null">detail = #{value.detail},</if>
			<if test="value != null and value.misc != null">misc = #{value.misc},</if>
			<if test="value != null and value.createTime != null">create_time = #{value.createTime},</if>
			<if test="value != null and value.updateTime != null">update_time = #{value.updateTime},</if>
			<if test="value != null and value.isLeaf != null">is_leaf = #{value.isLeaf},</if>
			<if test="value != null and value.module != null">module = #{value.module},</if>
			<if test="value != null and value.classify != null">classify = #{value.classify},</if>
			<if test="value != null and value.typeCode != null">type_code = #{value.typeCode},</if>
			<if test="value != null and value.isCooperation != null">is_cooperation = #{value.isCooperation},</if>
			<if test="value != null and value.isSync != null">is_sync = #{value.isSync},</if>
			<if test="value != null and value.isBuy != null">is_buy = #{value.isBuy},</if>
			<if test="value != null and value.courseCount != null">course_count = #{value.courseCount},</if>
			<if test="value != null and value.chiefAcademy != null">chief_academy = #{value.chiefAcademy},</if>
		</set>
		<include refid="dynamic_where" />
	</update>

	<!-- 3.查询 -->
	<select id="findEntityListByCond" parameterType="java.util.Map"
		resultMap="BaseResultMap">
		select
		<include refid="dynamic_output" />
		from xd_course_product_category
<!-- 		left join xd_course_product_module on xd_course_product_category.module = xd_course_product_module.module  -->
		left join xd_module_info on xd_course_product_category.module = xd_module_info.module 
		left join xd_major_data on xd_course_product_category.type_code=xd_major_data.id
		and xd_course_product_category.module=xd_major_data.region
		<include refid="dynamic_where" />
		<include refid="dynamic_sort" />
		<include refid="dynamic_limit" />
	</select>

	<!-- 4.查询单个记录 -->
	<select id="findEntityById" parameterType="ProductCategoryModel"
		resultMap="BaseResultMap">
		select * from xd_course_product_category where id = #{id};
	</select>
	<!-- 根据栏目级联查询 -->
     <select id="cascadeQueryProduct" parameterType="java.util.Map" resultMap="BaseResultMap">
        select
        <include refid="dynamic_output"/>
        from xd_course_product_category
        left join xd_module_info on xd_course_product_category.module = xd_module_info.module
        <include refid="dynamic_where"/>
    </select>

	<!-- 5.根据条件删除 -->
	<delete id="deleteEntity" parameterType="java.util.Map">
		delete from xd_course_product_category
		<include refid="dynamic_where" />
	</delete>

	<!-- 动态语句:查询 -->
	<sql id="dynamic_where">
		<where>
			<if test="input != null and input.id != null">and xd_course_product_category.id =#{input.id}</if>
			<if test="input != null and input.ids != null">
				and xd_course_product_category.id in
				<foreach collection="input.ids" open="(" close=")"
					separator="," item="item" index="index">
					#{item}
				</foreach>
			</if>
			<if test="input != null and input.parentId != null">and xd_course_product_category.parent_id =#{input.parentId}</if>
			<if test="input != null and input.childId != null">and xd_course_product_category.child_id =#{input.childId}</if>
			<if test="input != null and input.showStatus != null">and xd_course_product_category.show_status =#{input.showStatus}</if>
			<if test="input != null and input.allParentId != null">and xd_course_product_category.all_parent_id =#{input.allParentId}</if>
			<if test="input != null and input.allChildId != null">and xd_course_product_category.all_child_id =#{input.allChildId}</if>
			<if test="input != null and input.level != null">and xd_course_product_category.level =#{input.level}</if>
			<if test="input != null and input.name != null">and xd_course_product_category.name =#{input.name}</if>
			<if test="input != null and input.pictureUrl != null">and xd_course_product_category.picture_url =#{input.pictureUrl}</if>
			<if test="input != null and input.showCover != null">and xd_course_product_category.show_cover =#{input.showCover}</if>
			<if test="input != null and input.courseCategoryType != null">and xd_course_product_category.course_category_type =#{input.courseCategoryType}
			</if>
			<if test="input != null and input.detail != null">and xd_course_product_category.detail =#{input.detail}</if>
			<if test="input != null and input.misc != null">and xd_course_product_category.misc =#{input.misc}</if>
			<if test="input != null and input.createTime != null">and xd_course_product_category.create_time =#{input.createTime}</if>
			<if test="input != null and input.updateTime != null">and xd_course_product_category.update_time =#{input.updateTime}</if>
			<if test="input != null and input.isLeaf != null">and xd_course_product_category.is_leaf =#{input.isLeaf}</if>
			<if test="input != null and input.classify != null">and xd_course_product_category.classify =#{input.classify}</if>
			<if test="input != null and input.typeCode != null">and xd_course_product_category.type_code =#{input.typeCode}</if>
			<!-- 产品分类模糊查询 -->
			<if test="input != null and input.examSchoolLike != null">and xd_major_data.major_info like concat('%',#{input.examSchoolLike},'%')</if>
			<if test="input != null and input.majorNameLike != null">and xd_major_data.name like concat('%',#{input.majorNameLike},'%')</if>
			<if test="input != null and input.typeCodeLike != null">and xd_course_product_category.type_code like concat('%',#{input.typeCodeLike},'%')</if>
			<!-- 按照地域查询 -->
			<if test="input != null and input.module != null">and xd_course_product_category.module =#{input.module}</if>
			<if test="input != null and input.isCooperation != null">and xd_course_product_category.is_cooperation =#{input.isCooperation}</if>
			<if test="input != null and input.isSync != null">and xd_course_product_category.is_sync =#{input.isSync}</if>
			<if test="input != null and input.isBuy != null">and xd_course_product_category.is_buy =#{input.isBuy}</if>
			<!-- 课程数目 -->
			<if test="input != null and input.courseCount != null">and xd_course_product_category.course_count =#{input.courseCount}</if>
			<!-- 学校 -->
			<if test="input != null and input.chiefAcademy != null">and xd_course_product_category.chief_academy =#{input.chiefAcademy}</if>
		
		
		</where>
	</sql>
	<!--动态语句:输出 -->
	<sql id="dynamic_output">
		<trim suffixOverrides=",">
			<if test="output != null and output.id != null">xd_course_product_category.id,</if>
			<if test="output != null and output.parentId != null">xd_course_product_category.parent_id,</if>
			<if test="output != null and output.childId != null">xd_course_product_category.child_id,</if>
			<if test="output != null and output.showStatus != null">xd_course_product_category.show_status,</if>
			<if test="output != null and output.allParentId != null">xd_course_product_category.all_parent_id,</if>
			<if test="output != null and output.allChildId != null">xd_course_product_category.all_child_id,</if>
			<if test="output != null and output.level != null">xd_course_product_category.level,</if>
			<if test="output != null and output.name != null">xd_course_product_category.name,</if>
			<if test="output != null and output.pictureUrl != null">xd_course_product_category.picture_url,</if>
			<if test="output != null and output.showCover != null">xd_course_product_category.show_cover,</if>
			<if test="output != null and output.courseCategoryType != null">xd_course_product_category.course_category_type,</if>
			<if test="output != null and output.detail != null">xd_course_product_category.detail,</if>
			<if test="output != null and output.misc != null">xd_course_product_category.misc,</if>
			<if test="output != null and output.createTime != null">xd_course_product_category.create_time,</if>
			<if test="output != null and output.updateTime != null">xd_course_product_category.update_time,</if>
			<if test="output != null and output.isLeaf != null">xd_course_product_category.is_leaf,</if>
			<if test="output != null and output.module != null">xd_course_product_category.module,</if>
			<if test="output != null and output.classify != null">xd_course_product_category.classify,</if>
			<if test="output != null and output.typeCode != null">xd_course_product_category.type_code,</if>
			<if test="output != null and output.moduleName != null">xd_module_info.module_name as moduleName,</if>
			<if test="output != null and output.majorName != null">xd_major_data.name as majorName,</if>
			<if test="output != null and output.majorInfo != null">xd_major_data.major_info as majorInfo,</if>
			<if test="output != null and output.isCooperation != null">xd_course_product_category.is_cooperation as isCooperation,</if>
			<if test="output != null and output.isSync != null">xd_course_product_category.is_sync as isSync,</if>
			<if test="output != null and output.isBuy != null">xd_course_product_category.is_buy as isBuy,</if>
			<if test="output != null and output.courseCount != null">xd_course_product_category.course_count as courseCount,</if>
			<if test="output != null and output.chiefAcademy != null">xd_course_product_category.chief_academy as chiefAcademy,</if>
		</trim>
	</sql>
	
	<sql id="dynamic_limit">
		<if
			test="limit != null and limit.limitStart != null and limit.limitCount != null">
			limit ${limit.limitStart}, ${limit.limitCount}
		</if>
	</sql>
	<sql id="dynamic_sort">
		<trim suffixOverrides=",">
			<if test="sort !=null">
				order by
			</if>
			<if
				test="sort != null and sort.id != null and ( sort.id == 'ASC' or sort.id == 'DESC' )">id ${sort.id},</if>
			<if
				test="sort != null and sort.createTime != null and ( sort.createTime == 'ASC' or sort.createTime == 'DESC' )">xd_course_product_category.create_time ${sort.createTime},</if>
			<if
				test="sort != null and sort.updateTime != null and ( sort.updateTime == 'ASC' or sort.updateTime == 'DESC' )">xd_course_product_category.update_time ${sort.updateTime},</if>
		</trim>
	</sql>
	
</mapper>